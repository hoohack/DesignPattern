## 享元模式

### 概述
在程序中可能需要根据某种条件创建大量的对象，比如权限对象需要在每一次查询的时候创建用户对象，如果用户多了，那么权限对象就多了。使用享元模式，可以每个权限对象只创建一次，第二次用户再请求的时候可以直接复用第一次创建的对象。享元模式就是运用共享技术有效地支持大量细粒度的对象。将程序中不变且重复出现的数据分离出来共享，称之为享元，通过共享享元对象来减少对内存的占用。把外部状态分离出来，放到外部，让应用在使用的时候进行维护，并在需要的时候传递给享元对象使用。

### 结构
![享元模式结构图](http://7u2eqw.com1.z0.glb.clouddn.com/享元模式结构图.jpg)

### 实现
使用用户权限管理来实现享元模式。因为在用户权限中，用户的数据是重复出现的，当在验证用户权限的时候要将用户数据授权到具体对象，这时候，就需要很多的对象，而每个对象包含的数据都是很少的，这就有了很多的细粒度对象，而且有大量的重复数据。用一个享元工厂来管理享元，控制对内部状态的共享，并且让外部能简单地使用共享数据。将安全实体（即用户）和权限的描述定义为享元，而和它们结合的人员数据作为外部数据。

### 总结与分析
享元模式的重点在于分离变与不变。把一个对象的状态分为内部状态和外部状态，内部状态是不变的，外部状态是可变的。通过共享不变的部分，减少对象数量并节约内存的目的。在享元对象需要的时候，可以从外部闯入外部状态给共享的对象，共享对象会在功能处理的时候，使用自己内部的状态和外部的状态。
